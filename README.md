# vk-messages-to-telegram
Tool for receive messages from Vk to Telegram bot

## Приложение для приема сообщений из Vk пересылка в Telegram через бота.

### Установка приложения:
1) Установить .NET 5.0 ([Клик](https://dotnet.microsoft.com/en-us/download/dotnet/5.0))
2) Скомпилировать для своей платформы с помощью команды dotnet publish ([Клик](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-publish))
3) Запустить и перейти к настройке.
4) После настройки можно установить как службу (в Windows) или сервиса (в Linux) 

### Настройка приложения:
1) Для работы приложения нужно:
  - токен созданного Telegram бота (с помощью [BotFather](https://t.me/botfather)) 
  - логин и пароль от аккаунта Vk и токен приложения Kate Mobile [получить](https://vkhost.github.io/)
2) После сборки запуска приложения надо перейти в корневую папку и отредактировать файл appsettings.json
3) Прописываем токен телеграм бота

```
    "TelegramBot": {
      "Token": "", // здесь надо прописать токен бота
      "AllowedChatId": 0,
      "AllowSendMessages": true
    },
```
4) Запускаем приложение, боту, который вы создали надо отправить команду /chatid, бот вернет Id чата, который нужно прописать в конфиге

```
    "TelegramBot": {
      "Token": "ваш токен",
      "AllowedChatId": 0, // тут надо прописать ID чата с вашим ботом
      "AllowSendMessages": true
    },
```
5) Прописываем данные от аккаунта Vk
```
    "Vk": {
        "Account": {
          "Login": "",      // email или телефон (лучше номер телефона)
          "Password": "",   // пароль от аккаунта
          "AccessToken": "" // токен для доступа к аккаунту (нужны права для работы с сообщениями)
        },
        "RequestsPerSecond": 2 // лучше не трогать, Vk Api не принимает больше 3-х запросов в секунду
      }
```
6) Сохраняем конфиг. Перезапускаем приложение.
9) Бот готов к работе!

### Управление и команды

- /conv · список с чатами из Vk. Личные сообщения, группы.
- /unreadconv · список с чатами из Vk, где есть непрочитанные сообщения
- /<id чата или диалога> (например /123) · выбирает конкретный диалог Vk. Можно написать в чат, если отправить какой-то текст без команды.
- /msg · отображает список последних сообщений в выбранном чате Vk.
- /unreadmsg · отображает список непрочитанных сообщений в выбранном чате Vk.
- /chatid · отображает текущий id чата с пользователем

### Возможности на текущий момент

1) ☑️ Просмотр списка бесед из Vk.
2) ☑️ Просмотр списка бесед из Vk, где есть непрочитанные сообщения.
3) ☑️ Просмотр последних сообщений и непрочитанных сообщений для конкретной беседы
   * ☑️ Текстовые сообщения
   * ☑️ Пересланные сообщения
   * ☑️ Ответы на сообщение
   * ☑️ Изображения
   * ☑️ Пересланные посты (стена)
   * ☑️ Документы
   * ☑️ Голосовые сообщения
   * ☑️ Стикеры
   * (❌ не готово) Голосования
   * (❌ не готово) Видео
4) ☑️ Возможность написать сообщение для конкретной беседы (только текст)
5) ☑️ Уведомление о новых непрочитанных сообщениях каждый час (настраиваемый промежуток)
6) (❌ не готово) Просмотр списка друзей (и друзей, которые онлайн)
7) (❌ не готово) Просмотр заявок в друзья
8) (❌ не готово) Возможность принимать и отклонять заявки в друзья

### Оптимизация:
1) (❌ не готово) Кеширование сопоставления имени пользователя и его ID
2) (❌ не готово) Кеширование сопоставления id чата + id сообщения и его значения
3) (❌ не готово) Оптимизация запросов VK Api
